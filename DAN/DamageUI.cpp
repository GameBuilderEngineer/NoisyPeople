//===================================================================================================================================
//【DamageUI.cpp】
// [作成者]HAL東京GP12A332 11 菅野 樹
// [作成日]2019/12/22
// [更新日]2019/12/22
//===================================================================================================================================

//===================================================================================================================================
//【インクルード】
//===================================================================================================================================
#include "DamageUI.h"
#include "TextureLoader.h"

//===================================================================================================================================
//【using宣言】
//===================================================================================================================================
using namespace DamageUINS;

//===================================================================================================================================
//【コンストラクタ】
//===================================================================================================================================
DamageUI::DamageUI()
{
	sprite = new Sprite();
	//UI情報の設定
	sprite->initialize(
		*textureNS::reference(textureNS::UI_DAMAGE),		//テクスチャポインタ
		SpriteNS::CENTER,									//原点
		WIDTH,												//幅
		HEIGHT,												//高さ
		POSITION1,											//位置
		ROTATION,											//回転
		COLOR												//色
	);
	for (int i = 0; i < gameMasterNS::PLAYER_NUM; i++)
	{
		displayTime[i] = 0;
	}
}

//===================================================================================================================================
//【デストラクタ】
//===================================================================================================================================
DamageUI::~DamageUI()
{
	SAFE_DELETE(sprite);
}

//===================================================================================================================================
//【更新】
//===================================================================================================================================
void DamageUI::damaged(int playerNo)
{
	displayTime[playerNo] = DISPLAY_TIME;
	sprite->setAlphaAllVertex(255);
}

//===================================================================================================================================
//【更新】
//===================================================================================================================================
void DamageUI::update(float frameTime)
{
	for (int i = 0; i < gameMasterNS::PLAYER_NUM; i++)
	{
		if (displayTime[i] > 0)
		{
			displayTime[i] -= frameTime;
		}
		else {
			displayTime[i] = 0.0f;
		}
	}
}

//===================================================================================================================================
//【更新】
//===================================================================================================================================
void DamageUI::render(int playerNo)
{
	switch (playerNo)
	{
	case gameMasterNS::PLAYER_1P:
		sprite->setPosition(POSITION1);
		break;
	case gameMasterNS::PLAYER_2P:
		sprite->setPosition(POSITION2);
		break;
	}
	sprite->setAlphaAllVertex((int)(255.0f*displayTime[playerNo]));
	sprite->setVertex();
	sprite->render();
}


