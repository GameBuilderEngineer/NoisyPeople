//===================================================================================================================================
//ÅySky.cppÅz
// [çÏê¨é“]HALìåãûGP12A332 11 êõñÏ é˜
// [çÏê¨ì˙]2019/10/20
// [çXêVì˙]2019/10/20
//===================================================================================================================================

//===================================================================================================================================
//ÅyÉCÉìÉNÉãÅ[ÉhÅz
//===================================================================================================================================
#include "Sky.h"

//===================================================================================================================================
//ÅyÉRÉìÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
Sky::Sky() {
	renderer = new StaticMeshObject(staticMeshNS::reference(staticMeshNS::SKY_DOME));
	renderer->disableLight();
	initialize();
};

//===================================================================================================================================
//ÅyÉfÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
Sky::~Sky() {
	SAFE_DELETE(renderer);
};

//===================================================================================================================================
//Åyèâä˙âªÅz
//===================================================================================================================================
void Sky::initialize() {
	D3DXVECTOR3 position;
	for (int i = 0; i < skyNS::NUM; i++)
	{
		position = D3DXVECTOR3(0,0,0);
		generate(position);
	}
	needUpdate = true;
};

//===================================================================================================================================
//ÅyçXêVÅz
//===================================================================================================================================
void Sky::update()
{
	if (!needUpdate)return;
	renderer->update();
	needUpdate = false;
}

//===================================================================================================================================
//Åyï`âÊÅz
//===================================================================================================================================
void Sky::render(D3DXMATRIX view, D3DXMATRIX projection, D3DXVECTOR3 cameraPositon)
{
	renderer->render(*shaderNS::reference(shaderNS::INSTANCE_STATIC_MESH), view, projection, cameraPositon);
}

//===================================================================================================================================
//Åyê∂ê¨Åz
//===================================================================================================================================
void Sky::generate(D3DXVECTOR3 position)
{
	Object* object = new Object();
	renderer->generateObject(object);
	object->initialize(&position);
}
