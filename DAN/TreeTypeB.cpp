//===================================================================================================================================
//ÅyTreeTypeB.cppÅz
// [çÏê¨é“]HALìåãûGP12A332 11 êõñÏ é˜
// [çÏê¨ì˙]2019/10/14
// [çXêVì˙]2019/10/23
//===================================================================================================================================

//===================================================================================================================================
//ÅyÉCÉìÉNÉãÅ[ÉhÅz
//===================================================================================================================================
#include "TreeTypeB.h"

//===================================================================================================================================
//ÅyÉRÉìÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
TreeTypeB::TreeTypeB() {
	num = 400;
	renderer = new StaticMeshRenderer(staticMeshNS::reference(staticMeshNS::GREEN_TREE_002));
	initialize();
};

//===================================================================================================================================
//ÅyÉfÉXÉgÉâÉNÉ^Åz
//===================================================================================================================================
TreeTypeB::~TreeTypeB() {
	SAFE_DELETE_ARRAY(object);
	SAFE_DELETE(renderer);
};

//===================================================================================================================================
//Åyèâä˙âªÅz
//===================================================================================================================================
void TreeTypeB::initialize() {
	object = new Object[num];
	D3DXVECTOR3 position;
	D3DXVECTOR3 deltaScale;
	for (int i = 0; i < num; i++)
	{
		position.x = (float)((rand() % 2000) - 1000);
		position.y = 0.0f;
		position.z = (float)((rand() % 2000) - 1000);
		object[i].initialize(&position);
		
		deltaScale.x = (float)((rand() % 100))*0.01;
		deltaScale.y = (float)((rand() % 100))*0.01;
		deltaScale.z = (float)((rand() % 100))*0.01;

		object[i].scale += deltaScale;

		renderer->registerObject(&object[i]);//ÉåÉìÉ_ÉâÅ[Ç÷ìoò^
	}
	needUpdate = true;
};

//===================================================================================================================================
//ÅyçXêVÅz
//===================================================================================================================================
void TreeTypeB::update()
{
	if (!needUpdate)return;
	renderer->update();
	needUpdate = false;
}

//===================================================================================================================================
//Åyï`âÊÅz
//===================================================================================================================================
void TreeTypeB::render(D3DXMATRIX view, D3DXMATRIX projection, D3DXVECTOR3 cameraPositon)
{
	renderer->render(*shaderNS::reference(shaderNS::INSTANCE_STATIC_MESH), view, projection, cameraPositon);
}

